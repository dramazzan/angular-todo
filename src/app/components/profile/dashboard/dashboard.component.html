<div class="dashboard-container" *ngIf="user; else loadingOrError">

  <div class="modal-overlay" *ngIf="isModalOpen" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <app-edit-profile [user]="user" (userUpdated)="closeModalWhenSuccess($event)">
      </app-edit-profile>
      <button class="close-button" (click)="closeModal()">X</button>
    </div>
  </div>

  <h2>–ü–∞–Ω–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>

  <div class="user-profile-card">
    <div class="user-avatar">
      {{ user.name.charAt(0).toUpperCase() }}
    </div>
    <div class="user-name">{{ user.name }}</div>
    <div class="user-role">{{ user.role }}</div>

    <a [routerLink]="['/cases']" class="action-card">
      <div class="action-icon">üìÅ</div>
      <div>–ú–æ–∏ –¥–µ–ª–∞</div>
    </a>
  </div>

  <div class="user-info-card">
    <div class="info-title">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ</div>

    <div class="info-item">
      <div class="info-label">–ò–º—è:</div>
      <div class="info-value">{{ user.name }}</div>
    </div>

    <div class="info-item">
      <div class="info-label">–ü–æ—á—Ç–∞:</div>
      <div class="info-value">{{ user.email }}</div>
    </div>

    <div class="info-item">
      <div class="info-label">–õ–æ–≥–∏–Ω:</div>
      <div class="info-value">{{ user.login }}</div>
    </div>

    <div class="info-item">
      <div class="info-label">–†–æ–ª—å:</div>
      <div class="info-value">{{ user.role }}</div>
    </div>
  </div>

  <div class="actions-card">
    <div class="actions-title">–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</div>
    <div class="actions-grid">
      <a [routerLink]="['/cases']" class="action-card">
        <div class="action-icon">üìÅ</div>
        <div>–ú–æ–∏ –∑–∞–¥–∞—á–∏</div>
      </a>
      <a *ngIf="isAdmin" [routerLink]="['/admin']" class="action-card">
        <div class="action-icon">üîê</div>
        <div>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</div>
      </a>
      <a [routerLink]="['/cases']" class="action-card">
        <div class="action-icon">‚ûï</div>
        <div>–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</div>
      </a>
      <button (click)="openModal()" class="action-card">
        <div class="action-icon">‚úèÔ∏è</div>
        <div>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</div>
      </button>
      <button (click)="logout()" class="action-card">
        <div class="action-icon">üö™</div>
        <div>–í—ã–π—Ç–∏</div>
      </button>
    </div>
  </div>
</div>

<ng-template #loadingOrError>
  <div *ngIf="errorMessage; else loading" class="error-container">
    <p class="error">{{ errorMessage }}</p>
  </div>
  <ng-template #loading>
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <p class="loading-text">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
    </div>
  </ng-template>
</ng-template>
